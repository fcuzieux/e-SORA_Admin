import{s as h}from"./index-DKJS5z-D.js";async function g(e,t,s){const r=Date.now(),i=`${t}/${s}/${r}_${e.name}`,{error:n}=await h.storage.from("sora-file").upload(i,e,{cacheControl:"3600",upsert:!1});if(n)throw console.error("Error uploading file:",n),new Error(`Failed to upload file: ${n.message}`);const{data:{publicUrl:a}}=h.storage.from("sora-file").getPublicUrl(i);return a}async function l(e,t,s){const r=e.map(async i=>{const n=await g(i,t,s);return{name:i.name,url:n,size:i.size,type:i.type}});return Promise.all(r)}async function j(e,t){var r,i,n,a,F,p,u,m;const s={...e};return((i=(r=e.drone)==null?void 0:r.technicalDocuments)==null?void 0:i.length)>0&&e.drone.technicalDocuments.some(o=>o instanceof File)&&(s.drone={...s.drone,technicalDocuments:await l(e.drone.technicalDocuments,t,"technical")}),((a=(n=e.operation)==null?void 0:n.geoFiles)==null?void 0:a.length)>0&&e.operation.geoFiles.some(o=>o instanceof File)&&(s.operation={...s.operation,geoFiles:await l(e.operation.geoFiles,t,"geo")}),((p=(F=e.RiskAssessment)==null?void 0:F.trajgeoFiles)==null?void 0:p.length)>0&&e.RiskAssessment.trajgeoFiles.some(o=>o instanceof File)&&(s.RiskAssessment={...s.RiskAssessment,trajgeoFiles:await l(e.RiskAssessment.trajgeoFiles,t,"trajectory")}),((m=(u=e.RiskAssessment)==null?void 0:u.droseraOutputFile)==null?void 0:m.length)>0&&e.RiskAssessment.droseraOutputFile.some(o=>o instanceof File)&&(s.RiskAssessment={...s.RiskAssessment,droseraOutputFile:await l(e.RiskAssessment.droseraOutputFile,t,"drosera")}),s}export{j as prepareFormDataForSave,g as uploadFile,l as uploadFiles};
